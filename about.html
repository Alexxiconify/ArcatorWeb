<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>About Us - Arcator.co.uk</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Google Fonts - Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Link to theme_variables.css for centralized CSS variables -->
  <link rel="stylesheet" href="theme_variables.css">
  <!-- Link to navbar.css for navbar specific styling -->
  <link rel="stylesheet" href="navbar.css">

  <style>
    /* Base styles, will be overridden by CSS variables from themes.js */
    body {
      font-family: 'Inter', sans-serif;
      transition: background-color 0.3s ease, color 0.3s ease;
      background-color: var(--color-body-bg);
      color: var(--color-text-primary);
      background-image: linear-gradient(45deg, rgba(0,0,0,0.1) 25%, transparent 25%, transparent 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1) 75%, transparent 75%, transparent);
      background-size: 20px 20px;
      background-attachment: fixed;
    }

    /* Hero Banner styles - common for all themes, retains background image */
    .hero-banner {
      /* Replaced with a reliable placeholder URL */
      background-image: url('https://jylina.arcator.co.uk/standalone/img/creativespawn.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      min-height: 250px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    .hero-banner::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5); /* Dark overlay for text readability */
      z-index: 1;
    }
    .hero-content {
      position: relative;
      z-index: 2;
      color: white;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
    }

    /* Dynamic theme application for various elements */
    .bg-content-section {
      background-color: var(--color-bg-content-section) !important;
    }
    .bg-card {
      background-color: var(--color-bg-card) !important;
    }
    .bg-navbar { /* Used for footer also */
      background-color: var(--color-bg-navbar) !important;
    }
    .text-primary {
      color: var(--color-text-primary) !important;
    }
    .text-secondary {
      color: var(--color-text-secondary) !important;
    }
    .text-heading-main {
      color: var(--color-heading-main) !important;
    }
    .text-heading-card {
      color: var(--color-heading-card) !important;
    }
    .bg-blue-600 { /* For buttons */
      background-color: var(--color-button-blue-bg) !important;
      color: var(--color-button-text) !important;
    }
    .hover\:bg-blue-700:hover {
      background-color: var(--color-button-blue-hover) !important;
    }
    .hover\:text-primary:hover { /* For footer links */
      color: var(--color-text-primary) !important;
    }
  </style>
</head>
<body class="antialiased">
<!-- Navbar Placeholder -->
<div id="navbar-placeholder" class="w-full absolute top-0 left-0"></div>

<!-- Hero Section with Background Image -->
<section class="hero-banner rounded-b-lg shadow-xl" style="margin-top: 64px;"> <!-- Added margin-top to account for fixed navbar height -->
  <div class="container mx-auto px-4 text-center hero-content">
    <h1 class="text-5xl md:text-6xl font-extrabold mb-4 leading-tight">About Arcator.co.uk</h1>
    <p class="text-xl md:text-2xl mb-8">Our Journey, Mission, and Community Values</p>
  </div>
</section>

<!-- Main Content Section -->
<section class="py-16 bg-content-section rounded-lg shadow-inner mx-4 my-8">
  <div class="container mx-auto px-4">
    <!-- Our Story & Mission -->
    <div class="mb-12">
      <h2 class="text-4xl font-bold text-heading-main text-center mb-8">Our Story & Mission</h2>
      <div class="max-w-4xl mx-auto text-lg leading-relaxed text-secondary space-y-6">
        <p>Arcator.co.uk began its journey in <span class="font-semibold text-primary">October 2012</span>, born from a passion for Minecraft and a desire to create a stable, engaging, and friendly online community. What started as a small venture quickly grew into a vibrant hub for players seeking unique experiences beyond the standard game.</p>
        <p>Our mission is simple: to provide a long-lasting, fun, and safe environment for Minecraft players of all ages and backgrounds. We believe in fostering a community where creativity flourishes, friendships are made, and every player feels welcome and valued. We are committed to continuous improvement, adapting to the evolving landscape of Minecraft while upholding the core values that have defined us for over a decade.</p>
        <p>Over the years, we've hosted countless adventures, witnessed incredible builds, and built a dedicated global community. We are passionate about Minecraft and even more passionate about the community we've built together.</p>
      </div>
    </div>

    <!-- Our Core Values -->
    <div class="mb-12">
      <h2 class="text-4xl font-bold text-heading-main text-center mb-10">Our Core Values</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto">
        <!-- Value Card 1 -->
        <div class="bg-card p-6 rounded-lg shadow-md">
          <h3 class="text-2xl font-bold text-heading-card mb-3">Community First</h3>
          <p class="text-secondary">We prioritize a welcoming and inclusive atmosphere where every player feels respected and heard. Community is the foundation that drives our development.</p>
        </div>
        <!-- Value Card 2 -->
        <div class="bg-card p-6 rounded-lg shadow-md">
          <h3 class="text-2xl font-bold text-heading-card mb-3">Innovation & Fun</h3>
          <p class="text-secondary">We constantly explore new ways to enhance the Minecraft experience, introducing fresh content, challenges, and features to keep things exciting for our players.</p>
        </div>
        <!-- Value Card 3 -->
        <div class="bg-card p-6 rounded-lg shadow-md">
          <h3 class="text-2xl font-bold text-heading-card mb-3">Stability & Reliability</h3>
          <p class="text-secondary">Our robust infrastructure and dedicated administration ensure a smooth, low-lag gameplay experience with high uptime and secure data.</p>
        </div>
        <!-- Value Card 4 -->
        <div class="bg-card p-6 rounded-lg shadow-md">
          <h3 class="text-2xl font-bold text-heading-card mb-3">Transparency & Communication</h3>
          <p class="text-secondary">We believe in open communication with our community, sharing insights into server development, plans, and decisions that affect our players.</p>
        </div>
      </div>
    </div>

    <!-- Join Our Thriving Community! -->
    <div class="text-center">
      <h2 class="text-4xl font-bold text-heading-main mb-6">Join Our Thriving Community!</h2>
      <p class="text-lg leading-relaxed text-secondary max-w-3xl mx-auto mb-8">
        The heart of Arcator is its community. Join our Discord server to chat, connect with other players, participate in discussions, and get real-time updates.
      </p>
      <a href="https://discord.gg/GwArgw2" target="_blank" rel="noopener noreferrer" class="inline-block bg-blue-600 text-white font-bold py-3 px-8 rounded-full hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg">Join Our Discord</a>
    </div>

    <!-- What's Happening in Our Community: -->
    <div class="mt-12">
      <h2 class="text-4xl font-bold text-heading-main text-center mb-10">What's Happening in Our Community:</h2>
      <div class="max-w-4xl mx-auto text-lg leading-relaxed text-secondary space-y-4">
        <ul class="list-disc list-inside space-y-2">
          <li><span class="font-semibold text-primary">**Regular Events**</span> From building competitions to mini-game tournaments, there's always something happening!</li>
          <li><span class="font-semibold text-primary">**Active Voice Chat**</span> Hangout, connect with other members in our Discord voice channels for lively discussions and gaming sessions.</li>
          <li><span class="font-semibold text-primary">**Community Suggestions**</span> We actively listen to player feedback and implement suggestions to improve the server.</li>
          <li><span class="font-semibold text-primary">**Collaborative Builds**</span> Participate in large-scale community projects and leave your mark on the Arcator world.</li>
          <li><span class="font-semibold text-primary">**Creative Cinematography**</span> Utilize footage from the Arcator YouTube channel, showcasing players' creations in cinematic masterpieces.</li>
          <li><span class="font-semibold text-primary">**Historical Cartography**</span> Explore the world's history in 1:1,000 scale, historical maps.</li>
          <li><span class="font-semibold text-primary">**Lore Building**</span> Provide ready-to-use documents to aid in the creation of unique histories for settlements.</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- Footer Section -->
<footer class="bg-navbar py-8 text-secondary rounded-t-lg shadow-inner mt-8">
  <div class="container mx-auto px-4">
    <p>© 2012 - <span id="current-year-about"></span> Arcator.co.uk. All rights reserved.</p>
    <p class="mt-2">Made with ❤️ for the Minecraft Community.</p>
    <div class="flex flex-wrap justify-center space-x-6 mt-4">
      <a href="privacy.html" class="hover:text-primary transition duration-300 ease-in-out">Privacy Policy</a>
      <a href="terms.html" class="hover:text-primary transition duration-300 ease-in-out">Terms of Service</a>
      <a href="https://wiki.arcator.co.uk/" target="_blank" rel="noopener noreferrer" class="hover:text-primary transition duration-300 ease-in-out">Wiki</a>
      <a href="infrastructure.html" class="hover:text-primary transition duration-300 ease-in-out">Infrastructure</a>
      <a href="admin_and_dev.html" class="hover:text-primary transition duration-300 ease-in-out">Admin & Dev</a>
    </div>
  </div>
</footer>

<!-- Main page scripts -->
<!-- IMPORTANT: firebase-init.js must be loaded first to ensure Firebase is initialized -->
<script type="module" src="./firebase-init.js"></script>
<script type="module" src="./themes.js"></script>
<script type="module" src="./navbar.js"></script>
<script type="module" src="./about.js"></script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
  // Import setupThemesFirebase from themes.js
  import { setupThemesFirebase, applyTheme, getAvailableThemes } from './themes.js';
  // Import loadNavbar from navbar.js
  import { loadNavbar } from './navbar.js';


  // Firebase configuration object
  const firebaseConfig = {
    apiKey: "AIzaSyCP5Zb1CRermAKn7p_S30E8qzCbvsMxhm4",
    authDomain: "arcator-web.firebaseapp.com",
    projectId: "arcator-web",
    storageBucket: "arcator-web.firebasestorage.app",
    messagingSenderId: "1033082068049",
    appId: "1:1033082068049:web:dd154c8b188bde1930ec70",
    measurementId: "G-DJXNT1L7CM"
  };

  const canvasAppId = typeof __app_id !== 'undefined' ? __app_id : null;
  const appId = canvasAppId || firebaseConfig.projectId || 'default-app-id';


  let app;
  let auth;
  let db;
  let firebaseReadyPromise; // Promise to ensure Firebase is fully initialized and authenticated

  const DEFAULT_PROFILE_PIC = 'https://placehold.co/32x32/1F2937/E5E7EB?text=AV'; // Default placeholder
  const DEFAULT_THEME_NAME = 'dark'; // Default theme name

  /**
   * Fetches user profile data from Firestore.
   * @param {string} uid - The user's UID.
   * @returns {Promise<Object|null>} - User profile data or null if not found.
   */
  async function getUserProfileFromFirestore(uid) {
    await firebaseReadyPromise; // Ensure Firebase is initialized
    if (!db) {
      console.error("Firestore DB not initialized for getUserProfileFromFirestore.");
      return null;
    }
    const userDocRef = doc(db, `artifacts/${appId}/public/data/user_profiles`, uid);
    try {
      const docSnap = await getDoc(userDocRef);
      if (docSnap.exists()) {
        return docSnap.data();
      }
    } catch (error) {
      console.error("Error fetching user profile from Firestore:", error);
    }
    return null;
  }

  // Initialize Firebase and setup firebaseReadyPromise
  firebaseReadyPromise = new Promise((resolve) => {
    try {
      app = initializeApp(firebaseConfig);
      auth = getAuth(app);
      db = getFirestore(app);
      console.log("Firebase initialized successfully.");
      setupThemesFirebase(db, auth, appId); // Pass Firebase instances to themes.js

// Critical: Ensure auth state is settled before resolving
      const unsubscribe = onAuthStateChanged(auth, (user) => {
        console.log("onAuthStateChanged triggered during initialization. User:", user ? user.uid : "none");
        unsubscribe(); // Unsubscribe after the first call

// Perform initial sign-in if in Canvas and no user is already authenticated
        if (typeof __initial_auth_token !== 'undefined' && !user) {
          signInWithCustomToken(auth, __initial_auth_token)
            .then(() => console.log("DEBUG: Signed in with custom token from Canvas (infrastructure page) during init."))
            .catch((error) => {
              console.error("ERROR: Error signing in with custom token (infrastructure page) during init:", error);
              signInAnonymously(auth) // Fallback to anonymous sign-in if custom token fails
                .then(() => console.log("DEBUG: Signed in anonymously (infrastructure page) after custom token failure during init."))
                .catch((anonError) => console.error("ERROR: Error signing in anonymously on infrastructure page during init:", anonError));
            })
            .finally(() => resolve()); // Resolve promise after token attempt
        } else if (!user && typeof __initial_auth_token === 'undefined') {
          signInAnonymously(auth)
            .then(() => console.log("DEBUG: Signed in anonymously (no custom token) on infrastructure page during init."))
            .catch((anonError) => console.error("ERROR: Error signing in anonymously on infrastructure page during init:", anonError))
            .finally(() => resolve());
        }
        else {
          resolve(); // Resolve immediately if user is already authenticated or no token to use
        }
      });
    } catch (e) {
      console.error("Error initializing Firebase (initial block):", e);
      resolve(); // Resolve immediately on error to prevent infinite loading
    }
  });


  // Main execution logic on window load
  window.onload = async function() {
// Wait for Firebase to be ready before proceeding
    await firebaseReadyPromise;

// Pass the necessary Firebase instances and theme-related functions
// loadNavbar no longer expects applyTheme or getAvailableThemes as direct arguments
    await loadNavbar({ auth, db, appId }, DEFAULT_PROFILE_PIC, DEFAULT_THEME_NAME);
    document.getElementById('current-year-infra').textContent = new Date().getFullYear();

// After everything is loaded and Firebase is ready, apply the user's theme
    onAuthStateChanged(auth, async (user) => {
      let userThemePreference = null;
      if (user) {
        const userProfile = await getUserProfileFromFirestore(user.uid);
        userThemePreference = userProfile?.themePreference;
      }
// Apply the theme: user's preference, or 'dark' default
      const allThemes = await getAvailableThemes();
      const themeToApply = allThemes.find(t => t.id === userThemePreference) || allThemes.find(t => t.id === DEFAULT_THEME_NAME);
      applyTheme(themeToApply.id, themeToApply);
    });
  };
</script>
</body>
</html>
