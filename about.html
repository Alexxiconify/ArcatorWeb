<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>About - Arcator.co.uk</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Google Fonts - Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Link to theme_variables.css for centralized CSS variables -->
  <link rel="stylesheet" href="theme_variables.css">
  <!-- Link to common.css for shared styles -->
  <link href="common.css" rel="stylesheet">
  <!-- Favicon link -->
  <link rel="icon" type="image/png" href="favicon.png">
  <style>
    /* Base styles, will be overridden by CSS variables from themes.js */
    body {
      font-family: 'Inter', sans-serif;
      transition: background-color 0.3s ease, color 0.3s ease;
      background-image: linear-gradient(45deg, rgba(0, 0, 0, 0.1) 25%, transparent 25%, transparent 50%, rgba(0, 0, 0, 0.1) 50%, rgba(0, 0, 0, 0.1) 75%, transparent 75%, transparent);
      background-size: 20px 20px;
      background-attachment: fixed;
    }

    /* Hero Banner styles - common for all themes, retains background image */
    .hero-banner {
      background-image: url('https://jylina.arcator.co.uk/standalone/img/creativespawn.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      min-height: 400px; /* Increased height for visual impact */
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .hero-banner::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5); /* Dark overlay for text readability */
      z-index: 1;
    }

    .hero-content {
      position: relative;
      z-index: 2;
      color: white;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    /* Feature card specific styling */
    .feature-card {
      border-radius: 0.75rem;
      padding: 2rem;
      box-shadow: 0 10px 15px rgba(0, 0, 0, 0.3);
      transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
    }

    .feature-card:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 0 15px 20px rgba(0, 0, 0, 0.5);
    }

    .minecraft-ip-box {
      border: 2px solid var(--color-border-ip-box);
      box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
    }

    .text-white { /* Ensure white text remains white where explicitly needed, e.g., IP addresses */
      color: white !important;
    }

    /* Content section styling */
    .content-section {
      border-radius: 0.75rem;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      margin: 2rem 1rem;
    }

    .content-card {
      border: 1px solid var(--color-input-border);
      border-radius: 0.75rem;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      transition: all 0.2s ease-in-out;
    }

    .content-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2);
    }

    /* List styling */
    .feature-list {
      list-style-type: disc;
      list-style-position: inside;
    }

    .feature-list li {
      margin-bottom: 0.5rem;
      line-height: 1.6;
    }

    .feature-list .highlight {
      font-weight: 600;
    }

    .tab-container {
      display: flex;
      justify-content: center;
      margin-bottom: 2rem;
      border-bottom: 2px solid var(--color-input-border);
    }

    .tab-button {
      border: none;
      padding: 1rem 2rem;
      margin: 0 0.5rem;
      border-radius: 0.75rem 0.75rem 0 0;
      cursor: pointer;
      font-weight: 600;
      font-size: 1.1rem;
      transition: all 0.3s;
      border-bottom: 3px solid transparent;
    }

    .tab-button.active {
      border-bottom-color: var(--color-link);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    @media (max-width: 768px) {
      .tab-container {
        flex-direction: column;
        align-items: center;
      }

      .tab-button {
        margin: 0.25rem 0;
        border-radius: 0.5rem;
        width: 100%;
        max-width: 300px;
      }

      .tab-button.active {
        border-bottom-color: transparent;
      }
    }
  </style>
</head>
<body class="antialiased">
<!-- Navbar Placeholder -->
<div id="navbar-placeholder" class="w-full absolute top-0 left-0"></div>

<!-- Hero Section with Background Image -->
<section class="hero-banner rounded-b-lg shadow-xl" style="margin-top: 64px;"> <!-- Added margin-top to account for fixed navbar height -->
  <div class="container mx-auto px-4 text-center hero-content">
    <h1 class="text-5xl md:text-6xl font-extrabold mb-4 leading-tight">About Arcator.co.uk</h1>
    <p class="text-xl md:text-2xl mb-8">Our Journey, Community, and Interests</p>
  </div>
</section>

<!-- Main Content Section -->
<div class="container mx-auto px-4 mt-8">
  <div class="tab-container">
    <button class="tab-button active" onclick="showTab('about')">About</button>
    <button class="tab-button" onclick="showTab('discord')">Discord</button>
    <button class="tab-button" onclick="showTab('census')">Census</button>
    <button class="tab-button" onclick="showTab('infrastructure')">Infrastructure</button>
  </div>
</div>

<div class="tab-content active" id="about-tab">
  <!-- About content from original about.html -->
  <section class="content-section">
    <div class="container mx-auto px-4">
      <!-- Our Story & Mission -->
      <div class="mb-12">
        <h2 class="text-4xl font-bold text-heading-main text-center mb-8">Our Story & Mission</h2>
        <div class="max-w-4xl mx-auto text-lg leading-relaxed text-text-secondary space-y-6">
          <p>Arcator.co.uk began in <span class="font-semibold text-text-primary">October 2010</span> from a passion for
            Minecraft and a desire to create a stable, engaging community. What started as a small venture grew into a
            vibrant hub for players seeking unique experiences.</p>
          <p>Our mission is to provide a long-lasting, fun, and safe environment for Minecraft players of all ages. We
            foster creativity, friendships, and continuous improvement while upholding the core values that have defined
            us for over a decade.</p>
        </div>
      </div>
      <!-- Our Core Values -->
      <div class="mb-12">
        <h2 class="text-4xl font-bold text-heading-main text-center mb-10">Our Core Values</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto">
          <div class="content-card">
            <h3 class="text-2xl font-bold text-heading-card mb-3">Community First</h3>
            <p class="text-text-secondary">Welcoming and inclusive atmosphere where every player feels respected and
              heard.</p>
          </div>
          <div class="content-card">
            <h3 class="text-2xl font-bold text-heading-card mb-3">Innovation & Fun</h3>
            <p class="text-text-secondary">Constantly explore new ways to enhance the Minecraft experience with fresh
              content and features.</p>
          </div>
          <div class="content-card">
            <h3 class="text-2xl font-bold text-heading-card mb-3">Stability & Reliability</h3>
            <p class="text-text-secondary">Robust infrastructure ensuring smooth, low-lag gameplay with high uptime and
              secure data.</p>
          </div>
          <div class="content-card">
            <h3 class="text-2xl font-bold text-heading-card mb-3">Communication</h3>
            <p class="text-text-secondary">Open communication sharing insights into server development and community
              decisions.</p>
          </div>
        </div>
      </div>
      <!-- Community Highlights -->
      <div class="text-center mb-12">
        <h2 class="text-4xl font-bold text-heading-main mb-6">Join Our Thriving Community!</h2>
        <p class="text-lg leading-relaxed text-text-secondary max-w-3xl mx-auto mb-8">
          Connect with fellow builders, participate in events, and be part of a welcoming community that shares your
          love for creativity and adventure.
        </p>
        <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-8 mt-12">
          <a class="inline-block bg-blue-600 text-white font-bold py-3 px-8 rounded-full hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg" href="https://discord.gg/GwArgw2" rel="noopener noreferrer"
             target="_blank">Join Our Discord</a>
          <a class="inline-block bg-green-600 text-white font-bold py-3 px-8 rounded-full hover:bg-green-700 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg"
             href="https://docs.google.com/spreadsheets/d/1T25WAAJekQAjrU-dhVtDFgiIqJHHlaGIOySToTWrrp8/edit?usp=sharing" rel="noopener noreferrer"
             target="_blank">View Community Interests</a>
        </div>
      </div>
      <!-- External Services -->
      <div class="text-center mb-12">
        <h2 class="text-4xl font-bold text-heading-main text-center mb-10">Online Maps</h2>
        <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-8 mt-12">
          <a class="inline-block bg-blue-600 text-white font-bold py-3 px-8 rounded-full hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg"
             href="https://ssmp.arcator.co.uk/" rel="noopener noreferrer" target="_blank">Bluemap SSMP</a>
          <a class="inline-block bg-blue-600 text-white font-bold py-3 px-8 rounded-full hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg"
             href="https://hub.arcator.co.uk/#creative" rel="noopener noreferrer" target="_blank">Bluemap Hub</a>
        </div>
      </div>
    </div>
  </section>
</div>

<div class="tab-content" id="discord-tab">
  <!-- Community content from original community.html -->
  <section class="py-16 bg-content-section rounded-lg shadow-inner mx-4 my-8">
    <div class="container mx-auto px-4">
      <h2 class="text-4xl font-bold text-heading-main text-center mb-10">Connect & Engage</h2>
      <div class="max-w-4xl mx-auto text-lg leading-relaxed text-text-secondary space-y-6">
        <p>Our Discord server is the primary hub for real-time chat, announcements, support, and connecting with other
          members. Whether you're looking for group activities, sharing your latest builds, or just a friendly chat, our
          Discord is the place to be.</p>
        <p>Beyond Discord, we encourage members to share their diverse interests, fostering a rich and welcoming
          environment for everyone.</p>
      </div>
      <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-8 mt-12">
        <a class="inline-block bg-blue-600 text-white font-bold py-3 px-8 rounded-full hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg" href="https://discord.gg/GwArgw2" rel="noopener noreferrer"
           target="_blank">Join
          Our Discord</a>
        <a class="inline-block bg-green-600 text-white font-bold py-3 px-8 rounded-full hover:bg-green-700 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg"
           href="https://docs.google.com/spreadsheets/d/1T25WAAJekQAjrU-dhVtDFgiIqJHHlaGIOySToTWrrp8/edit?usp=sharing" rel="noopener noreferrer"
           target="_blank">View
          Community Interests</a>
      </div>
    </div>
  </section>
  <section class="py-16 bg-card rounded-lg shadow-inner mx-4 my-8">
    <div class="container mx-auto px-4">
      <h2 class="text-4xl font-bold text-heading-main text-center mb-10">Discord Features</h2>
      <div class="max-w-4xl mx-auto">
        <table class="discord-features-table">
          <thead>
          <tr>
            <th class="py-3 px-6 text-xl">Feature</th>
            <th class="py-3 px-6 text-xl">What You'll Find</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td class="py-4 px-6 font-semibold text-text-primary">Community Chat</td>
            <td class="py-4 px-6"><p class="text-text-secondary">Engage in lively discussions about Minecraft, share
              your builds, ask questions, and connect with players from around the world.</p></td>
          </tr>
          <tr>
            <td class="py-4 px-6 font-semibold text-text-primary">Server Status</td>
            <td class="py-4 px-6"><p class="text-text-secondary">Get real-time updates about server status, maintenance,
              and any issues.</p></td>
          </tr>
          <tr>
            <td class="py-4 px-6 font-semibold text-text-primary">Voice Channels</td>
            <td class="py-4 px-6"><p class="text-text-secondary">Join voice channels to chat while playing, coordinate
              group activities, or just hang out with fellow community members.</p></td>
          </tr>
          <tr>
            <td class="py-4 px-6 font-semibold text-text-primary">Events & Announcements</td>
            <td class="py-4 px-6"><p class="text-text-secondary">Stay informed about upcoming events, competitions,
              server updates, and community announcements.</p></td>
          </tr>
          <tr>
            <td class="py-4 px-6 font-semibold text-text-primary">Help & Support</td>
            <td class="py-4 px-6"><p class="text-text-secondary">Get help from staff and experienced players, report
              issues, and find answers to your questions quickly.</p></td>
          </tr>
          <tr>
            <td class="py-4 px-6 font-semibold text-text-primary">Build Showcase</td>
            <td class="py-4 px-6"><p class="text-text-secondary">Share screenshots and videos of your creations, get
              feedback from the community, and inspire others with your builds.</p></td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>
  <section class="py-16 bg-content-section rounded-lg shadow-inner mx-4 my-8">
    <div class="container mx-auto px-4">
      <h2 class="text-4xl font-bold text-heading-main text-center mb-10">Why Join Our Discord?</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-10 max-w-5xl mx-auto">
        <div class="feature-card"><h3 class="text-2xl font-bold text-heading-card mb-4">Real-time Chat & Support</h3>
          <p class="text-text-secondary">Get instant help, chat with staff, and connect with other players who share
            your passion for Minecraft and more.</p></div>
        <div class="feature-card"><h3 class="text-2xl font-bold text-heading-card mb-4">Event Participation</h3>
          <p class="text-text-secondary">Be the first to know about upcoming server events, mini-games, building
            contests, and community gatherings.</p></div>
        <div class="feature-card"><h3 class="text-2xl font-bold text-heading-card mb-4">Announcements & Updates</h3>
          <p class="text-text-secondary">Stay informed with server status updates, new feature releases, and important
            community news directly in Discord.</p></div>
        <div class="feature-card"><h3 class="text-2xl font-bold text-heading-card mb-4">Share Your Creations</h3>
          <p class="text-text-secondary">Showcase your Minecraft builds, share fan art, or just hang out in voice
            channels with friends.</p></div>
      </div>
    </div>
  </section>
</div>

<div class="tab-content" id="census-tab">
  <!-- Interests content with Google Sheets data table -->
  <section class="py-16 bg-card rounded-lg shadow-inner mx-4 my-8">
    <div class="container mx-auto px-4">
      <!-- Loading State -->
      <div class="flex justify-center items-center py-12" id="interests-loading">
        <div class="animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-blue-500"></div>
        <span class="ml-4 text-text-secondary">Loading community interests...</span>
      </div>

      <!-- Error State -->
      <div class="hidden text-center py-12" id="interests-error">
        <div class="text-red-400 text-xl mb-4">⚠️ Unable to load interests data</div>
        <p class="text-text-secondary mb-4">We're having trouble loading the community interests. Please try again
          later.</p>
        <button class="btn-primary btn-blue" id="retry-interests-btn">Retry Loading</button>
      </div>

      <!-- Table Container -->
      <div class="hidden" id="interests-table-container">
        <!-- Search and Filter Controls -->
        <div class="mb-6 flex flex-col sm:flex-row gap-4 items-center justify-between">
          <div class="flex flex-col sm:flex-row gap-4 items-center">
            <div class="relative">
              <input class="pl-10 pr-4 py-2 border border-input-border rounded-lg bg-input-bg text-input-text focus:border-link focus:outline-none" id="interests-search" placeholder="Search interests..."
                     type="text">
              <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-secondary" fill="none"
                   stroke="currentColor" viewBox="0 0 24 24">
                <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke-linecap="round" stroke-linejoin="round"
                      stroke-width="2"></path>
              </svg>
            </div>
            <select class="px-4 py-2 border border-input-border rounded-lg bg-input-bg text-input-text focus:border-link focus:outline-none"
                    id="interests-category-filter">
              <option value="">All Categories</option>
            </select>
          </div>
          <div class="text-text-secondary text-sm">
            <span id="interests-count">0</span> interests found
          </div>
        </div>

        <!-- Interests Table -->
        <div class="overflow-x-auto">
          <table class="w-full bg-card border border-input-border rounded-lg overflow-hidden" id="interests-table">
            <thead class="bg-table-th-bg">
            <tr>
              <th class="px-6 py-4 text-left text-table-th-text font-semibold cursor-pointer hover:bg-opacity-80"
                  onclick="sortTable('interest')">
                Interest
                <svg class="inline w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" stroke-linecap="round" stroke-linejoin="round"
                        stroke-width="2"></path>
                </svg>
              </th>
              <th class="px-6 py-4 text-left text-table-th-text font-semibold cursor-pointer hover:bg-opacity-80"
                  onclick="sortTable('category')">
                Category
                <svg class="inline w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" stroke-linecap="round" stroke-linejoin="round"
                        stroke-width="2"></path>
                </svg>
              </th>
              <th class="px-6 py-4 text-left text-table-th-text font-semibold cursor-pointer hover:bg-opacity-80"
                  onclick="sortTable('members')">
                Members
                <svg class="inline w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" stroke-linecap="round" stroke-linejoin="round"
                        stroke-width="2"></path>
                </svg>
              </th>
              <th class="px-6 py-4 text-left text-table-th-text font-semibold">Description</th>
            </tr>
            </thead>
            <tbody class="divide-y divide-table-td-border" id="interests-table-body">
            <!-- Table rows will be populated by JavaScript -->
            </tbody>
          </table>
        </div>

        <!-- No Results Message -->
        <div class="hidden text-center py-12" id="interests-no-results">
          <div class="text-text-secondary text-xl mb-4">🔍 No interests found</div>
          <p class="text-text-secondary">Try adjusting your search terms or filters.</p>
        </div>
      </div>
    </div>
  </section>
</div>

<div class="tab-content" id="infrastructure-tab">
  <!-- Infrastructure content from original infrastructure.html -->
  <section class="py-16 bg-content-section rounded-lg shadow-inner mx-4 my-8">
    <div class="container mx-auto px-4">
      <h2 class="text-4xl font-bold text-heading-main text-center mb-10">Our Robust Network Setup</h2>
      <div class="max-w-4xl mx-auto text-lg leading-relaxed text-text-secondary space-y-6 text-center">
        <p>Arcator's stability and performance are built upon a foundation of dedicated and well-maintained server
          infrastructure. We utilize a blend of powerful machines and strategic network configurations to ensure a
          seamless and low-latency experience for all our players across various Minecraft servers and services.</p>
        <p>Our setup is designed for efficiency, reliability, and scalability, allowing us to host diverse gamemodes,
          critical background services, and provide robust redundancy measures.</p>
      </div>

      <div class="mt-12 overflow-x-auto rounded-lg shadow-xl">
        <table class="min-w-full bg-card">
          <thead>
          <tr class="bg-table-th-bg text-table-th-text">
            <th class="py-3 px-6 text-xl">Hostname</th>
            <th class="py-3 px-6 text-xl">Primary Role</th>
          </tr>
          </thead>
          <tbody>
          <tr class="text-text-primary border-t border-table-td-border">
            <td>jylina</td>
            <td>Main Minecraft Server Host (s1)</td>
          </tr>
          <tr class="text-text-primary bg-table-row-even-bg border-t border-table-td-border">
            <td>thoth</td>
            <td>Raspberry Pi Minecraft Server (s2) / Backup Services</td>
          </tr>
          <tr class="text-text-primary border-t border-table-td-border">
            <td>sputnik</td>
            <td>Web Server / Load Balancer (s9)</td>
          </tr>
          </tbody>
        </table>
      </div>
      <p class="text-lg mt-12 text-text-secondary text-center">This setup allows us to efficiently manage different
        aspects of the network, from hosting Minecraft servers to handling critical background services and providing
        redundancy.</p>
    </div>
  </section>
</div>

<!-- Footer Section -->
<div id="footer-placeholder"></div>

<!-- Main page scripts -->
<script src="app.js" type="module"></script>
<script src="about.js" type="module"></script>
<script type="module">
  import {
    auth,
    getUserProfileFromFirestore,
    firebaseReadyPromise,
    DEFAULT_PROFILE_PIC,
    DEFAULT_THEME_NAME
  } from './firebase-init.js';
  import {loadNavbar, loadFooter} from './navbar.js';

  window.showTab = function (tabName) {
    const tabContents = document.querySelectorAll('.tab-content');
    tabContents.forEach(content => content.classList.remove('active'));
    const tabButtons = document.querySelectorAll('.tab-button');
    tabButtons.forEach(button => button.classList.remove('active'));
    document.getElementById(tabName + '-tab').classList.add('active');
    event.target.classList.add('active');

    // Load interests data when census tab is shown
    if (tabName === 'census' && interestsData.length === 0) {
      loadInterestsData();
    }
  };

  firebaseReadyPromise.then(async () => {
    let userProfile = null;
    if (auth.currentUser) {
      userProfile = await getUserProfileFromFirestore(auth.currentUser.uid);
    }
    await loadNavbar(auth.currentUser, userProfile, DEFAULT_PROFILE_PIC, DEFAULT_THEME_NAME);
    loadFooter('current-year-about');
    
    // Apply user's theme preference
    const userThemePreference = userProfile?.themePreference;
    const allThemes = await getAvailableThemes();
    const themeToApply = allThemes.find(t => t.id === userThemePreference) || allThemes.find(t => t.id === DEFAULT_THEME_NAME);
    if (themeToApply) {
      applyTheme(themeToApply.id, themeToApply);
      console.log(`About page: Applied theme ${themeToApply.id} (${themeToApply.name})`);
    }
    
    setTimeout(async () => {
      if (typeof window.forceRefreshNavbarState === 'function') {
        await window.forceRefreshNavbarState();
      }
    }, 500);
  });

  // Community Interests Table Functionality
  let interestsData = [];
  let filteredData = [];
  let currentSort = {column: 'interest', direction: 'asc'};

  // Load interests data from JSON file
  async function loadInterestsData() {
    const loadingEl = document.getElementById('interests-loading');
    const errorEl = document.getElementById('interests-error');
    const tableContainer = document.getElementById('interests-table-container');

    try {
      loadingEl.classList.remove('hidden');
      errorEl.classList.add('hidden');
      tableContainer.classList.add('hidden');

      console.log('[DEBUG] Loading census data from JSON file...');

      // Fetch from local JSON file
      const response = await fetch('census-data.json');

      if (!response.ok) {
        throw new Error(`Failed to fetch census data: ${response.status}`);
      }

      const jsonData = await response.json();
      console.log('[DEBUG] Successfully loaded census data:', jsonData.data.length, 'items');

      interestsData = jsonData.data;

    } catch (error) {
      console.warn('[DEBUG] Using fallback census data due to error:', error);
      console.log('[DEBUG] Error details:', error.message);

    

    // Initialize the table
    initializeInterestsTable();
  }

  // Initialize the interests table
  function initializeInterestsTable() {
    const loadingEl = document.getElementById('interests-loading');
    const tableContainer = document.getElementById('interests-table-container');

    loadingEl.classList.add('hidden');
    tableContainer.classList.remove('hidden');

    // Populate category filter
    populateCategoryFilter();

    // Render initial table
    renderInterestsTable();

    // Setup event listeners
    setupInterestsEventListeners();
  }

  // Populate category filter dropdown
  function populateCategoryFilter() {
    const categories = [...new Set(interestsData.map(item => item.category))].sort();
    const filterEl = document.getElementById('interests-category-filter');

    filterEl.innerHTML = '<option value="">All Categories</option>';
    categories.forEach(category => {
      const option = document.createElement('option');
      option.value = category;
      option.textContent = category;
      filterEl.appendChild(option);
    });
  }

  // Render the interests table
  function renderInterestsTable() {
    const tbody = document.getElementById('interests-table-body');
    const countEl = document.getElementById('interests-count');
    const noResultsEl = document.getElementById('interests-no-results');

    if (filteredData.length === 0) {
      tbody.innerHTML = '';
      noResultsEl.classList.remove('hidden');
      countEl.textContent = '0';
      return;
    }

    noResultsEl.classList.add('hidden');
    countEl.textContent = filteredData.length;

    tbody.innerHTML = filteredData.map(item => {
      // Create member count badge with color coding
      const getMemberBadgeClass = (count) => {
        if (count >= 5) return 'bg-green-100 text-green-800';
        if (count >= 3) return 'bg-blue-100 text-blue-800';
        if (count >= 1) return 'bg-yellow-100 text-yellow-800';
        return 'bg-gray-100 text-gray-800';
      };

      const memberBadgeClass = getMemberBadgeClass(item.members);

      return `
        <tr class="hover:bg-table-row-even-bg transition-colors">
          <td class="px-6 py-4 text-text-primary font-medium">${escapeHtml(item.interest)}</td>
          <td class="px-6 py-4">
            <span class="inline-block px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
              ${escapeHtml(item.category)}
            </span>
          </td>
          <td class="px-6 py-4">
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${memberBadgeClass}">
              <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
              </svg>
              ${item.members || '0'}
            </span>
          </td>
          <td class="px-6 py-4 text-text-secondary">${escapeHtml(item.description || '')}</td>
        </tr>
      `;
    }).join('');
  }

  // Setup event listeners for search and filtering
  function setupInterestsEventListeners() {
    const searchEl = document.getElementById('interests-search');
    const categoryFilterEl = document.getElementById('interests-category-filter');
    const retryBtn = document.getElementById('retry-interests-btn');

    // Search functionality
    searchEl.addEventListener('input', debounce(() => {
      applyFilters();
    }, 300));

    // Category filter
    categoryFilterEl.addEventListener('change', () => {
      applyFilters();
    });

    // Retry button
    retryBtn.addEventListener('click', () => {
      console.log('[DEBUG] Retry button clicked, reloading census data...');
      // Clear existing data and reload
      interestsData = [];
      filteredData = [];
      loadInterestsData();
    });
  }

  // Apply search and filter
  function applyFilters() {
    const searchTerm = document.getElementById('interests-search').value.toLowerCase();
    const categoryFilter = document.getElementById('interests-category-filter').value;

    filteredData = interestsData.filter(item => {
      const matchesSearch = !searchTerm ||
        item.interest.toLowerCase().includes(searchTerm) ||
        item.description.toLowerCase().includes(searchTerm) ||
        item.category.toLowerCase().includes(searchTerm);

      const matchesCategory = !categoryFilter || item.category === categoryFilter;

      return matchesSearch && matchesCategory;
    });

    // Apply current sort
    sortData(currentSort.column, currentSort.direction);
    renderInterestsTable();
  }

  // Sort table data
  function sortData(column, direction) {
    filteredData.sort((a, b) => {
      let aVal = a[column] || '';
      let bVal = b[column] || '';

      // Handle numeric values
      if (column === 'members') {
        aVal = parseInt(aVal) || 0;
        bVal = parseInt(bVal) || 0;
      } else {
        aVal = aVal.toString().toLowerCase();
        bVal = bVal.toString().toLowerCase();
      }

      if (direction === 'asc') {
        return aVal > bVal ? 1 : -1;
      } else {
        return aVal < bVal ? 1 : -1;
      }
    });
  }

  // Global sort function for table headers
  window.sortTable = function (column) {
    if (currentSort.column === column) {
      currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
    } else {
      currentSort.column = column;
      currentSort.direction = 'asc';
    }

    sortData(currentSort.column, currentSort.direction);
    renderInterestsTable();
  };

  // Utility functions
  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
      const later = () => {
        clearTimeout(timeout);
        func(...args);
      };
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
    };
  }
</script>
</body>
</html>
