<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Privacy Policy - Arcator.co.uk</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Google Fonts - Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Link to theme_variables.css for centralized CSS variables -->
  <link rel="stylesheet" href="theme_variables.css">
  <!-- Removed link to navbar.css as navbar is now embedded and styled directly -->

  <style>
    /* Base styles, will be overridden by CSS variables from themes.js */
    body {
      font-family: 'Inter', sans-serif;
      transition: background-color 0.3s ease, color 0.3s ease;
      background-color: var(--color-body-bg);
      color: var(--color-text-primary);
      background-image: linear-gradient(45deg, rgba(0,0,0,0.1) 25%, transparent 25%, transparent 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1) 75%, transparent 75%, transparent);
      background-size: 20px 20px;
      background-attachment: fixed;
    }

    /* Navbar specific styling using CSS variables */
    .navbar {
      background-color: var(--color-bg-navbar); /* Use CSS variable for navbar background */
    }
    .navbar-link {
      color: var(--color-text-secondary); /* Default link color */
    }
    .navbar-link:hover {
      color: var(--color-text-primary); /* Hover link color */
      background-color: var(--color-bg-card); /* Slightly different background on hover */
    }

    /* Hero Banner styles - common for all themes, retains background image */
    .hero-banner {
      background-image: url('https://jylina.arcator.co.uk/standalone/img/creativespawn.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      min-height: 250px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    .hero-banner::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1;
    }
    .hero-content {
      position: relative;
      z-index: 2;
      color: white;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
    }

    /* Dynamic theme application for various elements */
    .bg-gray-800 {
      background-color: var(--color-bg-content-section) !important;
    }
    .bg-gray-900 {
      background-color: var(--color-bg-navbar) !important; /* For footer */
    }
    .text-gray-100 {
      color: var(--color-text-primary) !important;
    }
    .text-gray-300 {
      color: var(--color-text-secondary) !important;
    }
    .text-gray-400 {
      color: var(--color-text-secondary) !important;
    }
    .text-gray-50 {
      color: var(--color-text-primary) !important; /* For logo/site title in navbar */
    }
    .text-blue-400 {
      color: var(--color-heading-main) !important; /* Using main heading color for consistent blue */
    }
    .text-blue-300 {
      color: var(--color-heading-card) !important; /* Using card heading color for consistent blue */
    }
    .hover\:text-white:hover { /* For footer links */
      color: var(--color-text-primary) !important;
    }
  </style>
</head>
<body class="antialiased">
<!-- Embedded Navbar -->
<header class="navbar py-4 shadow-lg w-full absolute top-0 left-0">
  <div class="container mx-auto flex flex-col md:flex-row justify-between items-center px-4">
    <!-- Logo/Site Title -->
    <a href="index.html" class="text-gray-50 text-3xl font-bold rounded-lg p-2 transition duration-300 ease-in-out hover:bg-gray-700">Arcator.co.uk</a>
    <!-- Navigation -->
    <nav class="mt-4 md:mt-0">
      <ul class="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-6">
        <li><a href="about.html" class="navbar-link text-lg font-medium rounded-md p-2 hover:bg-gray-800">About Us</a></li>
        <li><a href="servers.html" class="navbar-link text-lg font-medium rounded-md p-2 hover:bg-gray-800">Servers</a></li>
        <li><a href="community.html" class="navbar-link text-lg font-medium rounded-md p-2 hover:bg-gray-800">Community</a></li>
        <li><a href="interests.html" class="navbar-link text-lg font-medium rounded-md p-2 hover:bg-gray-800">Interests</a></li>
        <li><a href="games.html" class="navbar-link text-lg font-medium rounded-md p-2 hover:bg-gray-800">Games</a></li>
        <li><a href="https://wiki.arcator.co.uk/" target="_blank" rel="noopener noreferrer" class="navbar-link text-lg font-medium rounded-md p-2 hover:bg-gray-800">Wiki</a></li>
        <li><a href="forms.html" class="navbar-link text-lg font-medium rounded-md p-2 hover:bg-gray-800">Forms</a></li>
        <li><a href="sign.html" class="navbar-link text-lg font-medium rounded-md p-2 hover:bg-gray-800">Sign In / Account</a></li>
        <li><a href="index.html#join-us" class="navbar-link text-lg font-medium rounded-md p-2 hover:bg-gray-800">Join Us</a></li>
        <li><a href="donations.html" class="navbar-link text-lg font-medium rounded-md p-2 hover:bg-gray-800">Support Us</a></li>
      </ul>
    </nav>
  </div>
</header>

<!-- Hero Section with Background Image -->
<section class="hero-banner rounded-b-lg shadow-xl" style="margin-top: 64px;"> <!-- Added margin-top to account for fixed navbar height -->
  <div class="container mx-auto px-4 text-center hero-content">
    <h1 class="text-5xl md:text-6xl font-extrabold mb-4 leading-tight">Privacy Policy</h1>
  </div>
</section>

<!-- Privacy Policy Content Section -->
<section id="privacy-policy-content" class="py-16 bg-gray-800 rounded-lg shadow-inner mx-4 my-8">
  <div class="container mx-auto px-4 text-gray-100">
    <h2 class="text-3xl font-bold mb-6 text-blue-400">Introduction</h2>
    <p class="mb-4">Arcator.co.uk is committed to protecting your privacy. This Privacy Policy explains how we collect, use, and disclose information about you when you visit our website or use our services.</p>

    <h2 class="text-3xl font-bold mt-8 mb-6 text-blue-400">Information We Collect</h2>
    <h3 class="text-2xl font-semibold mb-4 text-blue-300">Personal Information</h3>
    <p class="mb-4">We do not directly collect personally identifiable information from visitors to this website unless explicitly provided (e.g., through contact forms). Any information shared on our Minecraft servers or Discord server is subject to the privacy policies of those respective platforms.</p>

    <h3 class="text-2xl font-semibold mt-8 mb-4 text-blue-300">Non-Personal Information</h3>
    <p class="mb-4">We may collect non-personal information about your visit to our website, such as browser type, operating system, and pages viewed. This information is used for analytical purposes to improve the website experience and is not linked to any individual.</p>

    <h2 class="text-3xl font-bold mt-8 mb-6 text-blue-400">How We Use Information</h2>
    <p class="mb-4">The non-personal information collected is used to understand website traffic patterns, improve content, and enhance user experience. We do not sell or rent any information to third parties.</p>

    <h2 class="text-3xl font-bold mt-8 mb-6 text-blue-400">Cookies</h2>
    <p class="mb-4">This website may use cookies to improve your browsing experience. You can choose to disable cookies through your browser settings, but this may affect the functionality of the website.</p>

    <h2 class="text-3xl font-bold mt-8 mb-6 text-blue-400">Third-Party Links</h2>
    <p class="mb-4">Our website may contain links to third-party websites. We are not responsible for the privacy practices or content of these third-party sites. We encourage you to review the privacy policies of any website you visit.</p>

    <h2 class="text-3xl font-bold mt-8 mb-6 text-blue-400">Changes to This Policy</h2>
    <p class="mb-4">We reserve the right to update or modify this Privacy Policy at any time. Any changes will be posted on this page. Your continued use of the website after any modifications indicates your acceptance of the updated policy.</p>

    <h2 class="text-3xl font-bold mt-8 mb-6 text-blue-400">Contact Us</h2>
    <p>If you have any questions about this Privacy Policy, please contact us through our Discord server or other official communication channels available on Arcator.co.uk.</p>
  </div>
</section>

<!-- Footer Section -->
<footer class="bg-gray-900 py-8 text-center text-gray-400 rounded-t-lg shadow-inner mt-8">
  <div class="container mx-auto px-4">
    <p>© 2012 - <span id="current-year-privacy"></span> Arcator.co.uk. All rights reserved.</p>
    <p class="mt-2">Made with ❤️ for the Minecraft Community.</p>
    <div class="flex flex-wrap justify-center space-x-6 mt-4">
      <a href="privacy.html" class="hover:text-white transition duration-300 ease-in-out text-blue-400">Privacy Policy</a>
      <a href="terms.html" class="hover:text-white transition duration-300 ease-in-out">Terms of Service</a>
      <a href="https://wiki.arcator.co.uk/" target="_blank" rel="noopener noreferrer" class="hover:text-white transition duration-300 ease-in-out">Wiki</a>
      <a href="infrastructure.html" class="hover:text-white transition duration-300 ease-in-out">Infrastructure</a>
      <a href="admin_and_dev.html" class="hover:text-white transition duration-300 ease-in-out">Admin & Dev</a>
    </div>
  </div>
</footer>

<!-- Firebase SDKs and Main Script -->
<script type="module">
  import { setupThemesFirebase, applyTheme, getAvailableThemes } from './themes.js';
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signInWithCustomToken, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

  // Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyCP5Zb1CRermAKn7p_S30E8qzCbvsMxhm4",
    authDomain: "arcator-web.firebaseapp.com",
    projectId: "arcator-web",
    storageBucket: "arcator-web.firebasestorage.app",
    messagingSenderId: "1033082068049",
    appId: "1:1033082068049:web:dd154c8b188bde1930ec70",
    measurementId: "G-DJXNT1L7CM"
  };

  const canvasAppId = typeof __app_id !== 'undefined' ? __app_id : null;
  const appId = canvasAppId || firebaseConfig.projectId || 'default-app-id';

  let app;
  let auth;
  let db;
  let firebaseReadyPromise; // Promise to ensure Firebase is fully initialized and authenticated

  const DEFAULT_THEME = 'dark';

  /**
   * Fetches user profile data from Firestore.
   * @param {string} uid - The user's UID.
   * @returns {Promise<Object|null>} - User profile data or null if not found.
   */
  async function getUserProfileFromFirestore(uid) {
    await firebaseReadyPromise; // Ensure Firebase is initialized
    if (!db) {
      console.error("Firestore DB not initialized for getUserProfileFromFirestore.");
      return null;
    }
    const userDocRef = doc(db, `artifacts/${appId}/public/data/user_profiles`, uid);
    try {
      const docSnap = await getDoc(userDocRef);
      if (docSnap.exists()) {
        return docSnap.data();
      }
    } catch (error) {
      console.error("Error fetching user profile from Firestore:", error);
    }
    return null;
  }

  // Initialize Firebase and setup firebaseReadyPromise
  firebaseReadyPromise = new Promise((resolve) => {
    try {
      app = initializeApp(firebaseConfig);
      auth = getAuth(app);
      db = getFirestore(app);
      console.log("Firebase initialized successfully.");
      setupThemesFirebase(db, auth, appId); // Pass Firebase instances to themes.js

      // Critical: Ensure auth state is settled before resolving
      const unsubscribe = onAuthStateChanged(auth, (user) => {
        console.log("onAuthStateChanged triggered during initialization. User:", user ? user.uid : "none");
        unsubscribe(); // Unsubscribe after the first call

        // Perform initial sign-in if in Canvas and no user is already authenticated
        if (typeof __initial_auth_token !== 'undefined' && !user) {
          signInWithCustomToken(auth, __initial_auth_token)
            .then(() => console.log("DEBUG: Signed in with custom token from Canvas (privacy page) during init."))
            .catch((error) => {
              console.error("ERROR: Error signing in with custom token (privacy page) during init:", error);
              signInAnonymously(auth) // Fallback to anonymous sign-in if custom token fails
                .then(() => console.log("DEBUG: Signed in anonymously (privacy page) after custom token failure during init."))
                .catch((anonError) => console.error("ERROR: Error signing in anonymously on privacy page during init:", anonError));
            })
            .finally(() => resolve()); // Resolve promise after token attempt
        } else if (!user && typeof __initial_auth_token === 'undefined') {
          signInAnonymously(auth)
            .then(() => console.log("DEBUG: Signed in anonymously (no custom token) on privacy page during init."))
            .catch((anonError) => console.error("ERROR: Error signing in anonymously on privacy page during init:", anonError))
            .finally(() => resolve());
        }
        else {
          resolve(); // Resolve immediately if user is already authenticated or no token to use
        }
      });
    } catch (e) {
      console.error("Error initializing Firebase (initial block):", e);
      resolve(); // Resolve immediately on error to prevent infinite loading
    }
  });

  // Main execution logic on window load
  window.onload = async function() {
    // Wait for Firebase to be ready before proceeding
    await firebaseReadyPromise;

    // Set current year for footer
    document.getElementById('current-year-privacy').textContent = new Date().getFullYear();

    // After everything is loaded and Firebase is ready, apply the user's theme
    onAuthStateChanged(auth, async (user) => {
      let userThemePreference = null;
      if (user) {
        const userProfile = await getUserProfileFromFirestore(user.uid);
        userThemePreference = userProfile?.themePreference;
      }
      // Apply the theme: user's preference, or 'dark' default
      const allThemes = await getAvailableThemes();
      const themeToApply = allThemes.find(t => t.id === userThemePreference) || allThemes.find(t => t.id === DEFAULT_THEME);
      applyTheme(themeToApply.id, themeToApply);
    });
  };
</script>
</body>
</html>
